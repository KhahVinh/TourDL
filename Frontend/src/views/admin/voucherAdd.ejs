<!-- views/addVoucher.ejs -->
<!DOCTYPE html>
<html lang="en">

<head>
  <title>Thêm mới voucher</title>
  <link rel="stylesheet" href="assets/css/voucher.css">
  <%- include('../partials/head') %>
  <style>
    /* CSS cho hiệu ứng trượt */
    .voucher__admin--add-form {
      display: none;
      position: absolute;
      top: -100%;
      left: 0;
      width: 100%;
      background-color: #fff;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      padding: 20px;
      z-index: 10;
      transition: top 0.3s ease-in-out;
    }

    .voucher__admin--add-form.show {
      display: block;
      top: 60px;
    }
  </style>
</head>

<body>
  <div class="voucher__admin--add-form" id="addVoucherForm">
    <h3>Thêm mới voucher</h3>
    <form id="addVoucherForm">
      <label for="voucherName">Tên voucher:</label>
      <input type="text" id="voucherName" name="voucherName" required>
      <br>
      <label for="voucherValue">Giá trị:</label>
      <input type="number" id="voucherValue" name="voucherValue" required>
      <br>
      <label for="voucherStartDate">Ngày bắt đầu:</label>
      <input type="datetime-local" id="voucherStartDate" name="voucherStartDate" required>
      <br>
      <label for="voucherExpiryDate">Ngày hết hạn:</label>
      <input type="datetime-local" id="voucherExpiryDate" name="voucherExpiryDate" required>
      <br>
      <button type="submit">Lưu</button>
      <button type="button" id="cancelAddVoucher">Hủy</button>
    </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    const addVoucherForm = document.getElementById('addVoucherForm');
    const cancelAddVoucherBtn = document.getElementById('cancelAddVoucher');

    // Xử lý form thêm mới voucher (có thể gọi API để lưu)
    document.querySelector("#addVoucherForm form").addEventListener("submit", async (event) => {
      event.preventDefault();
      const voucherData = {
        voucherName: document.getElementById("voucherName").value,
        voucherValue: document.getElementById("voucherValue").value,
        startDate: document.getElementById("voucherStartDate").value,
        expiryDate: document.getElementById("voucherExpiryDate").value
      };

      try {
        const response = await axios.post(`${URL_API_SERVER_V1}/vouchers`, voucherData);
        // Xử lý sau khi tạo thành công (thêm vào bảng hoặc thông báo)
        alert("Voucher đã được thêm!");
        window.location.href = '/voucher'; // Redirect về trang voucher sau khi thêm mới
      } catch (error) {
        console.error("Có lỗi xảy ra:", error);
        alert("Thêm voucher thất bại");
      }
    });

    // Khi nhấn nút Hủy
    cancelAddVoucherBtn.addEventListener('click', () => {
      window.location.href = '/voucher'; // Quay lại trang danh sách voucher
    });
  </script>
</body>

</html>
